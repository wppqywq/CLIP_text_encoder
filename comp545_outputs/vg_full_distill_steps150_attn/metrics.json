{
  "config": {
    "model_name": "ViT-B-32",
    "pretrained": "laion2b_s34b_b79k",
    "device_preference": "cuda",
    "seed": 42,
    "run_splits": [
      "train",
      "val",
      "test"
    ],
    "limit_images": null,
    "batch_size": 32,
    "k_values": [
      1,
      5,
      10
    ],
    "chunk_words": 8,
    "chunk_stride": 4,
    "chunk_threshold": 15,
    "text_pooling": "attn",
    "adapter_steps": 150,
    "adapter_lr": 1e-05,
    "adapter_logit_lr": 5e-07,
    "adapter_batch": 64,
    "adapter_hidden": 64,
    "distill_weights": [
      0.0,
      0.2,
      0.8
    ],
    "fine_grained_weight": 0.5,
    "cache_chunk_image_embeds": true,
    "teacher_cache_on_cpu": true,
    "output_name": "vg_full_distill_steps150_attn",
    "process_config": {
      "max_images": 5000,
      "max_regions_per_image": 6,
      "min_region_words": 3,
      "validation_ratio": 0.1,
      "test_ratio": 0.1,
      "seed": 42,
      "lowercase": false
    },
    "show_progress": true
  },
  "paths": {
    "repo_root": "/content/comp545_final_github",
    "data_root": "/content/drive/MyDrive/comp545_data",
    "raw_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome_raw",
    "processed_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome",
    "images_dir": "/content/drive/MyDrive/comp545_data/visual_genome/images",
    "output_dir": "/content/drive/MyDrive/comp545_outputs",
    "cache_dir": "/content/drive/MyDrive/comp545_outputs/cache"
  },
  "baseline_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.13606434405734288,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.13275,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.13866666666666666,
        "5": 0.321,
        "10": 0.43366666666666664
      },
      "i2t": {
        "1": 0.278,
        "5": 0.508,
        "10": 0.604
      }
    }
  },
  "chunk_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.1361060176696116,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.1335,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.138,
        "5": 0.32066666666666666,
        "10": 0.43333333333333335
      },
      "i2t": {
        "1": 0.278,
        "5": 0.506,
        "10": 0.602
      }
    }
  },
  "adapter_metrics": {
    "0.0": {
      "train": {
        "t2i": {
          "1": 0.0585930988498083,
          "5": 0.14177362893815637,
          "10": 0.2012835472578763
        },
        "i2t": {
          "1": 0.1435,
          "5": 0.2935,
          "10": 0.3755
        }
      },
      "val": {
        "t2i": {
          "1": 0.16066666666666668,
          "5": 0.35833333333333334,
          "10": 0.4756666666666667
        },
        "i2t": {
          "1": 0.31,
          "5": 0.59,
          "10": 0.724
        }
      },
      "test": {
        "t2i": {
          "1": 0.146,
          "5": 0.3396666666666667,
          "10": 0.45366666666666666
        },
        "i2t": {
          "1": 0.298,
          "5": 0.542,
          "10": 0.654
        }
      }
    },
    "0.2": {
      "train": {
        "t2i": {
          "1": 0.058176362727121185,
          "5": 0.14269044840806802,
          "10": 0.2019503250541757
        },
        "i2t": {
          "1": 0.144,
          "5": 0.29175,
          "10": 0.37725
        }
      },
      "val": {
        "t2i": {
          "1": 0.16233333333333333,
          "5": 0.36033333333333334,
          "10": 0.47333333333333333
        },
        "i2t": {
          "1": 0.312,
          "5": 0.594,
          "10": 0.724
        }
      },
      "test": {
        "t2i": {
          "1": 0.14566666666666667,
          "5": 0.3416666666666667,
          "10": 0.454
        },
        "i2t": {
          "1": 0.292,
          "5": 0.546,
          "10": 0.65
        }
      }
    },
    "0.8": {
      "train": {
        "t2i": {
          "1": 0.0582180363393899,
          "5": 0.14202367061176863,
          "10": 0.20170028338056342
        },
        "i2t": {
          "1": 0.14375,
          "5": 0.29225,
          "10": 0.376
        }
      },
      "val": {
        "t2i": {
          "1": 0.16266666666666665,
          "5": 0.3586666666666667,
          "10": 0.4726666666666667
        },
        "i2t": {
          "1": 0.31,
          "5": 0.594,
          "10": 0.722
        }
      },
      "test": {
        "t2i": {
          "1": 0.14833333333333334,
          "5": 0.3413333333333333,
          "10": 0.45366666666666666
        },
        "i2t": {
          "1": 0.298,
          "5": 0.546,
          "10": 0.652
        }
      }
    }
  },
  "loss_logs": {
    "0.00": [
      [
        0,
        5.851855278015137,
        50.000003814697266
      ],
      [
        10,
        3.856062412261963,
        49.99976348876953
      ],
      [
        20,
        3.690908193588257,
        49.9995231628418
      ],
      [
        30,
        4.074709892272949,
        49.99928283691406
      ],
      [
        40,
        4.834599494934082,
        49.99905014038086
      ],
      [
        50,
        3.6334738731384277,
        49.998809814453125
      ],
      [
        60,
        4.434659957885742,
        49.99856948852539
      ],
      [
        70,
        4.255568027496338,
        49.99833297729492
      ],
      [
        80,
        3.6327528953552246,
        49.99809646606445
      ],
      [
        90,
        4.373610973358154,
        49.99785614013672
      ],
      [
        100,
        3.8563852310180664,
        49.997703552246094
      ],
      [
        110,
        4.203547954559326,
        49.997581481933594
      ],
      [
        120,
        3.404106855392456,
        49.99745178222656
      ],
      [
        130,
        4.618293762207031,
        49.99732971191406
      ],
      [
        140,
        3.7907724380493164,
        49.99721145629883
      ],
      [
        149,
        3.835599899291992,
        49.99710464477539
      ]
    ],
    "0.20": [
      [
        0,
        4.497879981994629,
        49.9970817565918
      ],
      [
        10,
        5.073678493499756,
        49.99684143066406
      ],
      [
        20,
        3.6793689727783203,
        49.996604919433594
      ],
      [
        30,
        4.040016174316406,
        49.996368408203125
      ],
      [
        40,
        4.351500988006592,
        49.99612808227539
      ],
      [
        50,
        4.029601573944092,
        49.995887756347656
      ],
      [
        60,
        3.752674102783203,
        49.99564743041992
      ],
      [
        70,
        3.5183749198913574,
        49.99541473388672
      ],
      [
        80,
        3.4361495971679688,
        49.995174407958984
      ],
      [
        90,
        4.466542720794678,
        49.99494552612305
      ],
      [
        100,
        4.1422038078308105,
        49.99470901489258
      ],
      [
        110,
        3.617913007736206,
        49.994483947753906
      ],
      [
        120,
        3.6406407356262207,
        49.99436569213867
      ],
      [
        130,
        3.7329609394073486,
        49.99424362182617
      ],
      [
        140,
        3.972115993499756,
        49.99412536621094
      ],
      [
        149,
        3.428699254989624,
        49.9940185546875
      ]
    ],
    "0.80": [
      [
        0,
        4.231731414794922,
        49.99399185180664
      ],
      [
        10,
        4.330323219299316,
        49.99375534057617
      ],
      [
        20,
        4.042696952819824,
        49.9935188293457
      ],
      [
        30,
        3.8365836143493652,
        49.99327850341797
      ],
      [
        40,
        4.257685661315918,
        49.993038177490234
      ],
      [
        50,
        3.922628402709961,
        49.992801666259766
      ],
      [
        60,
        3.951916217803955,
        49.99256134033203
      ],
      [
        70,
        3.522287607192993,
        49.99232482910156
      ],
      [
        80,
        4.234744548797607,
        49.992088317871094
      ],
      [
        90,
        4.226685523986816,
        49.99184799194336
      ],
      [
        100,
        3.8921151161193848,
        49.99167251586914
      ],
      [
        110,
        4.098909854888916,
        49.99155044555664
      ],
      [
        120,
        3.5072150230407715,
        49.991432189941406
      ],
      [
        130,
        3.8619449138641357,
        49.991310119628906
      ],
      [
        140,
        3.4635071754455566,
        49.99119186401367
      ],
      [
        149,
        3.6484644412994385,
        49.991085052490234
      ]
    ]
  },
  "summary": [
    {
      "split": "train",
      "metric": "t2i@1",
      "baseline": 0.0571345224204034,
      "chunk_baseline": 0.0571345224204034,
      "adapter_0.00": 0.0585930988498083,
      "adapter_0.20": 0.058176362727121185,
      "adapter_0.80": 0.0582180363393899
    },
    {
      "split": "train",
      "metric": "t2i@5",
      "baseline": 0.13606434405734288,
      "chunk_baseline": 0.1361060176696116,
      "adapter_0.00": 0.14177362893815637,
      "adapter_0.20": 0.14269044840806802,
      "adapter_0.80": 0.14202367061176863
    },
    {
      "split": "train",
      "metric": "t2i@10",
      "baseline": 0.191073512252042,
      "chunk_baseline": 0.191073512252042,
      "adapter_0.00": 0.2012835472578763,
      "adapter_0.20": 0.2019503250541757,
      "adapter_0.80": 0.20170028338056342
    },
    {
      "split": "train",
      "metric": "i2t@1",
      "baseline": 0.13275,
      "chunk_baseline": 0.1335,
      "adapter_0.00": 0.1435,
      "adapter_0.20": 0.144,
      "adapter_0.80": 0.14375
    },
    {
      "split": "train",
      "metric": "i2t@5",
      "baseline": 0.27175,
      "chunk_baseline": 0.27175,
      "adapter_0.00": 0.2935,
      "adapter_0.20": 0.29175,
      "adapter_0.80": 0.29225
    },
    {
      "split": "train",
      "metric": "i2t@10",
      "baseline": 0.34625,
      "chunk_baseline": 0.34625,
      "adapter_0.00": 0.3755,
      "adapter_0.20": 0.37725,
      "adapter_0.80": 0.376
    },
    {
      "split": "val",
      "metric": "t2i@1",
      "baseline": 0.15366666666666667,
      "chunk_baseline": 0.15366666666666667,
      "adapter_0.00": 0.16066666666666668,
      "adapter_0.20": 0.16233333333333333,
      "adapter_0.80": 0.16266666666666665
    },
    {
      "split": "val",
      "metric": "t2i@5",
      "baseline": 0.3506666666666667,
      "chunk_baseline": 0.3506666666666667,
      "adapter_0.00": 0.35833333333333334,
      "adapter_0.20": 0.36033333333333334,
      "adapter_0.80": 0.3586666666666667
    },
    {
      "split": "val",
      "metric": "t2i@10",
      "baseline": 0.455,
      "chunk_baseline": 0.455,
      "adapter_0.00": 0.4756666666666667,
      "adapter_0.20": 0.47333333333333333,
      "adapter_0.80": 0.4726666666666667
    },
    {
      "split": "val",
      "metric": "i2t@1",
      "baseline": 0.29,
      "chunk_baseline": 0.29,
      "adapter_0.00": 0.31,
      "adapter_0.20": 0.312,
      "adapter_0.80": 0.31
    },
    {
      "split": "val",
      "metric": "i2t@5",
      "baseline": 0.54,
      "chunk_baseline": 0.54,
      "adapter_0.00": 0.59,
      "adapter_0.20": 0.594,
      "adapter_0.80": 0.594
    },
    {
      "split": "val",
      "metric": "i2t@10",
      "baseline": 0.684,
      "chunk_baseline": 0.684,
      "adapter_0.00": 0.724,
      "adapter_0.20": 0.724,
      "adapter_0.80": 0.722
    },
    {
      "split": "test",
      "metric": "t2i@1",
      "baseline": 0.13866666666666666,
      "chunk_baseline": 0.138,
      "adapter_0.00": 0.146,
      "adapter_0.20": 0.14566666666666667,
      "adapter_0.80": 0.14833333333333334
    },
    {
      "split": "test",
      "metric": "t2i@5",
      "baseline": 0.321,
      "chunk_baseline": 0.32066666666666666,
      "adapter_0.00": 0.3396666666666667,
      "adapter_0.20": 0.3416666666666667,
      "adapter_0.80": 0.3413333333333333
    },
    {
      "split": "test",
      "metric": "t2i@10",
      "baseline": 0.43366666666666664,
      "chunk_baseline": 0.43333333333333335,
      "adapter_0.00": 0.45366666666666666,
      "adapter_0.20": 0.454,
      "adapter_0.80": 0.45366666666666666
    },
    {
      "split": "test",
      "metric": "i2t@1",
      "baseline": 0.278,
      "chunk_baseline": 0.278,
      "adapter_0.00": 0.298,
      "adapter_0.20": 0.292,
      "adapter_0.80": 0.298
    },
    {
      "split": "test",
      "metric": "i2t@5",
      "baseline": 0.508,
      "chunk_baseline": 0.506,
      "adapter_0.00": 0.542,
      "adapter_0.20": 0.546,
      "adapter_0.80": 0.546
    },
    {
      "split": "test",
      "metric": "i2t@10",
      "baseline": 0.604,
      "chunk_baseline": 0.602,
      "adapter_0.00": 0.654,
      "adapter_0.20": 0.65,
      "adapter_0.80": 0.652
    }
  ]
}