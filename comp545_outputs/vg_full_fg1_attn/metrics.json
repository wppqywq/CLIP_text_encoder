{
  "config": {
    "model_name": "ViT-B-32",
    "pretrained": "laion2b_s34b_b79k",
    "device_preference": "cuda",
    "seed": 42,
    "run_splits": [
      "train",
      "val",
      "test"
    ],
    "limit_images": null,
    "batch_size": 32,
    "k_values": [
      1,
      5,
      10
    ],
    "chunk_words": 8,
    "chunk_stride": 4,
    "chunk_threshold": 15,
    "text_pooling": "attn",
    "adapter_steps": 300,
    "adapter_lr": 1e-05,
    "adapter_logit_lr": 5e-07,
    "adapter_batch": 64,
    "adapter_hidden": 64,
    "distill_weights": [
      0.0,
      0.2,
      0.8
    ],
    "fine_grained_weight": 1.0,
    "cache_chunk_image_embeds": true,
    "teacher_cache_on_cpu": true,
    "output_name": "vg_full_fg1_attn",
    "process_config": {
      "max_images": 5000,
      "max_regions_per_image": 6,
      "min_region_words": 3,
      "validation_ratio": 0.1,
      "test_ratio": 0.1,
      "seed": 42,
      "lowercase": false
    },
    "show_progress": true
  },
  "paths": {
    "repo_root": "/content/comp545_final_github",
    "data_root": "/content/drive/MyDrive/comp545_data",
    "raw_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome_raw",
    "processed_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome",
    "images_dir": "/content/drive/MyDrive/comp545_data/visual_genome/images",
    "output_dir": "/content/drive/MyDrive/comp545_outputs",
    "cache_dir": "/content/drive/MyDrive/comp545_outputs/cache"
  },
  "baseline_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.13606434405734288,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.13275,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.13866666666666666,
        "5": 0.321,
        "10": 0.43366666666666664
      },
      "i2t": {
        "1": 0.278,
        "5": 0.508,
        "10": 0.604
      }
    }
  },
  "chunk_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.1361060176696116,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.1335,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.138,
        "5": 0.32066666666666666,
        "10": 0.43333333333333335
      },
      "i2t": {
        "1": 0.278,
        "5": 0.506,
        "10": 0.602
      }
    }
  },
  "adapter_metrics": {
    "0.0": {
      "train": {
        "t2i": {
          "1": 0.057926321053508915,
          "5": 0.14685780963493916,
          "10": 0.20586764460743456
        },
        "i2t": {
          "1": 0.1445,
          "5": 0.296,
          "10": 0.39175
        }
      },
      "val": {
        "t2i": {
          "1": 0.17066666666666666,
          "5": 0.371,
          "10": 0.48833333333333334
        },
        "i2t": {
          "1": 0.31,
          "5": 0.606,
          "10": 0.74
        }
      },
      "test": {
        "t2i": {
          "1": 0.154,
          "5": 0.3536666666666667,
          "10": 0.4593333333333333
        },
        "i2t": {
          "1": 0.314,
          "5": 0.55,
          "10": 0.686
        }
      }
    },
    "0.2": {
      "train": {
        "t2i": {
          "1": 0.057759626604434074,
          "5": 0.14681613602267043,
          "10": 0.20615935989331555
        },
        "i2t": {
          "1": 0.146,
          "5": 0.29325,
          "10": 0.387
        }
      },
      "val": {
        "t2i": {
          "1": 0.16833333333333333,
          "5": 0.37,
          "10": 0.48733333333333334
        },
        "i2t": {
          "1": 0.32,
          "5": 0.61,
          "10": 0.74
        }
      },
      "test": {
        "t2i": {
          "1": 0.154,
          "5": 0.3546666666666667,
          "10": 0.463
        },
        "i2t": {
          "1": 0.316,
          "5": 0.558,
          "10": 0.678
        }
      }
    },
    "0.8": {
      "train": {
        "t2i": {
          "1": 0.05805134189031505,
          "5": 0.14660776796132688,
          "10": 0.20645107517919653
        },
        "i2t": {
          "1": 0.14675,
          "5": 0.2995,
          "10": 0.3885
        }
      },
      "val": {
        "t2i": {
          "1": 0.168,
          "5": 0.36866666666666664,
          "10": 0.49
        },
        "i2t": {
          "1": 0.316,
          "5": 0.594,
          "10": 0.738
        }
      },
      "test": {
        "t2i": {
          "1": 0.15233333333333332,
          "5": 0.35033333333333333,
          "10": 0.46
        },
        "i2t": {
          "1": 0.31,
          "5": 0.56,
          "10": 0.678
        }
      }
    }
  },
  "loss_logs": {
    "0.00": [
      [
        0,
        7.685462474822998,
        50.000003814697266
      ],
      [
        10,
        5.111805438995361,
        49.99976348876953
      ],
      [
        20,
        4.917863368988037,
        49.9995231628418
      ],
      [
        30,
        5.406389236450195,
        49.99928283691406
      ],
      [
        40,
        6.40287446975708,
        49.99905014038086
      ],
      [
        50,
        4.79182243347168,
        49.998809814453125
      ],
      [
        60,
        5.891438007354736,
        49.99856948852539
      ],
      [
        70,
        5.635939598083496,
        49.99833297729492
      ],
      [
        80,
        4.825168609619141,
        49.99809646606445
      ],
      [
        90,
        5.835227966308594,
        49.99785614013672
      ],
      [
        100,
        5.1145195960998535,
        49.997703552246094
      ],
      [
        110,
        5.590131759643555,
        49.9975700378418
      ],
      [
        120,
        4.507500171661377,
        49.9974365234375
      ],
      [
        130,
        6.169776916503906,
        49.997318267822266
      ],
      [
        140,
        5.013062000274658,
        49.997196197509766
      ],
      [
        150,
        5.137109756469727,
        49.9970817565918
      ],
      [
        160,
        5.826187610626221,
        49.99696350097656
      ],
      [
        170,
        4.325469493865967,
        49.99687957763672
      ],
      [
        180,
        4.761477470397949,
        49.99687957763672
      ],
      [
        190,
        5.195926189422607,
        49.99684143066406
      ],
      [
        200,
        4.9012227058410645,
        49.99677276611328
      ],
      [
        210,
        4.603851318359375,
        49.99674606323242
      ],
      [
        220,
        4.472848415374756,
        49.99674606323242
      ],
      [
        230,
        4.2134809494018555,
        49.99674606323242
      ],
      [
        240,
        5.497147560119629,
        49.99674606323242
      ],
      [
        250,
        5.164431571960449,
        49.99674606323242
      ],
      [
        260,
        4.592193603515625,
        49.996734619140625
      ],
      [
        270,
        4.661959648132324,
        49.996734619140625
      ],
      [
        280,
        4.713190078735352,
        49.996734619140625
      ],
      [
        290,
        5.007217884063721,
        49.996734619140625
      ],
      [
        299,
        4.367574214935303,
        49.996734619140625
      ]
    ],
    "0.20": [
      [
        0,
        5.620621681213379,
        49.99671173095703
      ],
      [
        10,
        5.769813537597656,
        49.9964714050293
      ],
      [
        20,
        5.356855869293213,
        49.99623489379883
      ],
      [
        30,
        5.122990608215332,
        49.995994567871094
      ],
      [
        40,
        5.638663291931152,
        49.995758056640625
      ],
      [
        50,
        5.164970397949219,
        49.995521545410156
      ],
      [
        60,
        5.281371116638184,
        49.99528121948242
      ],
      [
        70,
        4.6793317794799805,
        49.99504089355469
      ],
      [
        80,
        5.625065803527832,
        49.99480438232422
      ],
      [
        90,
        5.6203789710998535,
        49.99456787109375
      ],
      [
        100,
        5.16909646987915,
        49.994388580322266
      ],
      [
        110,
        5.443289279937744,
        49.99427032470703
      ],
      [
        120,
        4.660720348358154,
        49.99414825439453
      ],
      [
        130,
        5.127447128295898,
        49.9940299987793
      ],
      [
        140,
        4.613056182861328,
        49.9939079284668
      ],
      [
        150,
        4.561866283416748,
        49.99378967285156
      ],
      [
        160,
        5.245316505432129,
        49.99367141723633
      ],
      [
        170,
        5.7992329597473145,
        49.993553161621094
      ],
      [
        180,
        3.7933189868927,
        49.993446350097656
      ],
      [
        190,
        5.0489044189453125,
        49.99342346191406
      ],
      [
        200,
        5.773287296295166,
        49.993408203125
      ],
      [
        210,
        4.685365676879883,
        49.99332809448242
      ],
      [
        220,
        4.915395259857178,
        49.993289947509766
      ],
      [
        230,
        4.81919002532959,
        49.99327850341797
      ],
      [
        240,
        4.488277912139893,
        49.993221282958984
      ],
      [
        250,
        4.486073017120361,
        49.993221282958984
      ],
      [
        260,
        5.1966776847839355,
        49.993221282958984
      ],
      [
        270,
        5.343320846557617,
        49.993221282958984
      ],
      [
        280,
        4.399072170257568,
        49.993221282958984
      ],
      [
        290,
        4.482909679412842,
        49.99326705932617
      ],
      [
        299,
        4.7380757331848145,
        49.99333953857422
      ]
    ],
    "0.80": [
      [
        0,
        5.535889148712158,
        49.993316650390625
      ],
      [
        10,
        6.199367523193359,
        49.99307632446289
      ],
      [
        20,
        6.280289173126221,
        49.992835998535156
      ],
      [
        30,
        5.549133777618408,
        49.99259948730469
      ],
      [
        40,
        5.534830093383789,
        49.99235916137695
      ],
      [
        50,
        4.698247909545898,
        49.992122650146484
      ],
      [
        60,
        4.192277908325195,
        49.991886138916016
      ],
      [
        70,
        5.702574729919434,
        49.99164581298828
      ],
      [
        80,
        4.729188919067383,
        49.99140548706055
      ],
      [
        90,
        4.920264720916748,
        49.991214752197266
      ],
      [
        100,
        4.780986309051514,
        49.99109649658203
      ],
      [
        110,
        4.657289505004883,
        49.990867614746094
      ],
      [
        120,
        5.214797019958496,
        49.99065399169922
      ],
      [
        130,
        5.22177791595459,
        49.99053955078125
      ],
      [
        140,
        5.057053565979004,
        49.99041748046875
      ],
      [
        150,
        5.227431297302246,
        49.990299224853516
      ],
      [
        160,
        4.2362871170043945,
        49.99018096923828
      ],
      [
        170,
        5.011756420135498,
        49.99005889892578
      ],
      [
        180,
        4.682671546936035,
        49.98994064331055
      ],
      [
        190,
        4.63370943069458,
        49.98983383178711
      ],
      [
        200,
        5.190840721130371,
        49.98976135253906
      ],
      [
        210,
        4.431549549102783,
        49.989654541015625
      ],
      [
        220,
        5.084947109222412,
        49.98964309692383
      ],
      [
        230,
        5.113437652587891,
        49.989585876464844
      ],
      [
        240,
        4.430432319641113,
        49.989559173583984
      ],
      [
        250,
        5.236336708068848,
        49.989559173583984
      ],
      [
        260,
        4.18846321105957,
        49.989559173583984
      ],
      [
        270,
        4.036783695220947,
        49.989559173583984
      ],
      [
        280,
        4.817610740661621,
        49.989559173583984
      ],
      [
        290,
        4.913319110870361,
        49.989559173583984
      ],
      [
        299,
        4.433084487915039,
        49.989559173583984
      ]
    ]
  },
  "summary": [
    {
      "split": "train",
      "metric": "t2i@1",
      "baseline": 0.0571345224204034,
      "chunk_baseline": 0.0571345224204034,
      "adapter_0.00": 0.057926321053508915,
      "adapter_0.20": 0.057759626604434074,
      "adapter_0.80": 0.05805134189031505
    },
    {
      "split": "train",
      "metric": "t2i@5",
      "baseline": 0.13606434405734288,
      "chunk_baseline": 0.1361060176696116,
      "adapter_0.00": 0.14685780963493916,
      "adapter_0.20": 0.14681613602267043,
      "adapter_0.80": 0.14660776796132688
    },
    {
      "split": "train",
      "metric": "t2i@10",
      "baseline": 0.191073512252042,
      "chunk_baseline": 0.191073512252042,
      "adapter_0.00": 0.20586764460743456,
      "adapter_0.20": 0.20615935989331555,
      "adapter_0.80": 0.20645107517919653
    },
    {
      "split": "train",
      "metric": "i2t@1",
      "baseline": 0.13275,
      "chunk_baseline": 0.1335,
      "adapter_0.00": 0.1445,
      "adapter_0.20": 0.146,
      "adapter_0.80": 0.14675
    },
    {
      "split": "train",
      "metric": "i2t@5",
      "baseline": 0.27175,
      "chunk_baseline": 0.27175,
      "adapter_0.00": 0.296,
      "adapter_0.20": 0.29325,
      "adapter_0.80": 0.2995
    },
    {
      "split": "train",
      "metric": "i2t@10",
      "baseline": 0.34625,
      "chunk_baseline": 0.34625,
      "adapter_0.00": 0.39175,
      "adapter_0.20": 0.387,
      "adapter_0.80": 0.3885
    },
    {
      "split": "val",
      "metric": "t2i@1",
      "baseline": 0.15366666666666667,
      "chunk_baseline": 0.15366666666666667,
      "adapter_0.00": 0.17066666666666666,
      "adapter_0.20": 0.16833333333333333,
      "adapter_0.80": 0.168
    },
    {
      "split": "val",
      "metric": "t2i@5",
      "baseline": 0.3506666666666667,
      "chunk_baseline": 0.3506666666666667,
      "adapter_0.00": 0.371,
      "adapter_0.20": 0.37,
      "adapter_0.80": 0.36866666666666664
    },
    {
      "split": "val",
      "metric": "t2i@10",
      "baseline": 0.455,
      "chunk_baseline": 0.455,
      "adapter_0.00": 0.48833333333333334,
      "adapter_0.20": 0.48733333333333334,
      "adapter_0.80": 0.49
    },
    {
      "split": "val",
      "metric": "i2t@1",
      "baseline": 0.29,
      "chunk_baseline": 0.29,
      "adapter_0.00": 0.31,
      "adapter_0.20": 0.32,
      "adapter_0.80": 0.316
    },
    {
      "split": "val",
      "metric": "i2t@5",
      "baseline": 0.54,
      "chunk_baseline": 0.54,
      "adapter_0.00": 0.606,
      "adapter_0.20": 0.61,
      "adapter_0.80": 0.594
    },
    {
      "split": "val",
      "metric": "i2t@10",
      "baseline": 0.684,
      "chunk_baseline": 0.684,
      "adapter_0.00": 0.74,
      "adapter_0.20": 0.74,
      "adapter_0.80": 0.738
    },
    {
      "split": "test",
      "metric": "t2i@1",
      "baseline": 0.13866666666666666,
      "chunk_baseline": 0.138,
      "adapter_0.00": 0.154,
      "adapter_0.20": 0.154,
      "adapter_0.80": 0.15233333333333332
    },
    {
      "split": "test",
      "metric": "t2i@5",
      "baseline": 0.321,
      "chunk_baseline": 0.32066666666666666,
      "adapter_0.00": 0.3536666666666667,
      "adapter_0.20": 0.3546666666666667,
      "adapter_0.80": 0.35033333333333333
    },
    {
      "split": "test",
      "metric": "t2i@10",
      "baseline": 0.43366666666666664,
      "chunk_baseline": 0.43333333333333335,
      "adapter_0.00": 0.4593333333333333,
      "adapter_0.20": 0.463,
      "adapter_0.80": 0.46
    },
    {
      "split": "test",
      "metric": "i2t@1",
      "baseline": 0.278,
      "chunk_baseline": 0.278,
      "adapter_0.00": 0.314,
      "adapter_0.20": 0.316,
      "adapter_0.80": 0.31
    },
    {
      "split": "test",
      "metric": "i2t@5",
      "baseline": 0.508,
      "chunk_baseline": 0.506,
      "adapter_0.00": 0.55,
      "adapter_0.20": 0.558,
      "adapter_0.80": 0.56
    },
    {
      "split": "test",
      "metric": "i2t@10",
      "baseline": 0.604,
      "chunk_baseline": 0.602,
      "adapter_0.00": 0.686,
      "adapter_0.20": 0.678,
      "adapter_0.80": 0.678
    }
  ]
}