{
  "config": {
    "model_name": "ViT-B-32",
    "pretrained": "laion2b_s34b_b79k",
    "device_preference": "cuda",
    "seed": 42,
    "run_splits": [
      "train",
      "val",
      "test"
    ],
    "limit_images": null,
    "batch_size": 32,
    "k_values": [
      1,
      5,
      10
    ],
    "chunk_words": 8,
    "chunk_stride": 4,
    "chunk_threshold": 15,
    "text_pooling": "attn",
    "adapter_steps": 300,
    "adapter_lr": 1e-05,
    "adapter_logit_lr": 5e-07,
    "adapter_batch": 64,
    "adapter_hidden": 64,
    "distill_weights": [
      0.0,
      0.2,
      0.8
    ],
    "fine_grained_weight": 0.5,
    "cache_chunk_image_embeds": true,
    "teacher_cache_on_cpu": true,
    "output_name": "vg_full_fg0.5_attn",
    "process_config": {
      "max_images": 5000,
      "max_regions_per_image": 6,
      "min_region_words": 3,
      "validation_ratio": 0.1,
      "test_ratio": 0.1,
      "seed": 42,
      "lowercase": false
    },
    "show_progress": true
  },
  "paths": {
    "repo_root": "/content/comp545_final_github",
    "data_root": "/content/drive/MyDrive/comp545_data",
    "raw_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome_raw",
    "processed_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome",
    "images_dir": "/content/drive/MyDrive/comp545_data/visual_genome/images",
    "output_dir": "/content/drive/MyDrive/comp545_outputs",
    "cache_dir": "/content/drive/MyDrive/comp545_outputs/cache"
  },
  "baseline_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.13606434405734288,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.13275,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.13866666666666666,
        "5": 0.321,
        "10": 0.43366666666666664
      },
      "i2t": {
        "1": 0.278,
        "5": 0.508,
        "10": 0.604
      }
    }
  },
  "chunk_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.1361060176696116,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.1335,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.138,
        "5": 0.32066666666666666,
        "10": 0.43333333333333335
      },
      "i2t": {
        "1": 0.278,
        "5": 0.506,
        "10": 0.602
      }
    }
  },
  "adapter_metrics": {
    "0.0": {
      "train": {
        "t2i": {
          "1": 0.05780130021670278,
          "5": 0.1456076012668778,
          "10": 0.2041590265044174
        },
        "i2t": {
          "1": 0.14725,
          "5": 0.29775,
          "10": 0.39775
        }
      },
      "val": {
        "t2i": {
          "1": 0.168,
          "5": 0.371,
          "10": 0.48633333333333334
        },
        "i2t": {
          "1": 0.318,
          "5": 0.6,
          "10": 0.742
        }
      },
      "test": {
        "t2i": {
          "1": 0.155,
          "5": 0.352,
          "10": 0.4593333333333333
        },
        "i2t": {
          "1": 0.32,
          "5": 0.554,
          "10": 0.686
        }
      }
    },
    "0.2": {
      "train": {
        "t2i": {
          "1": 0.05755125854309052,
          "5": 0.1455242540423404,
          "10": 0.20515919319886647
        },
        "i2t": {
          "1": 0.14825,
          "5": 0.2975,
          "10": 0.393
        }
      },
      "val": {
        "t2i": {
          "1": 0.16866666666666666,
          "5": 0.37133333333333335,
          "10": 0.48633333333333334
        },
        "i2t": {
          "1": 0.322,
          "5": 0.618,
          "10": 0.738
        }
      },
      "test": {
        "t2i": {
          "1": 0.152,
          "5": 0.35433333333333333,
          "10": 0.46166666666666667
        },
        "i2t": {
          "1": 0.314,
          "5": 0.558,
          "10": 0.682
        }
      }
    },
    "0.8": {
      "train": {
        "t2i": {
          "1": 0.05738456409401567,
          "5": 0.1456076012668778,
          "10": 0.20553425570928488
        },
        "i2t": {
          "1": 0.14775,
          "5": 0.30075,
          "10": 0.39475
        }
      },
      "val": {
        "t2i": {
          "1": 0.16633333333333333,
          "5": 0.371,
          "10": 0.488
        },
        "i2t": {
          "1": 0.32,
          "5": 0.598,
          "10": 0.734
        }
      },
      "test": {
        "t2i": {
          "1": 0.15333333333333332,
          "5": 0.34833333333333333,
          "10": 0.461
        },
        "i2t": {
          "1": 0.314,
          "5": 0.568,
          "10": 0.686
        }
      }
    }
  },
  "loss_logs": {
    "0.00": [
      [
        0,
        5.851855278015137,
        50.000003814697266
      ],
      [
        10,
        3.856062412261963,
        49.99976348876953
      ],
      [
        20,
        3.690908193588257,
        49.9995231628418
      ],
      [
        30,
        4.074709892272949,
        49.99928283691406
      ],
      [
        40,
        4.834599494934082,
        49.99905014038086
      ],
      [
        50,
        3.6334738731384277,
        49.998809814453125
      ],
      [
        60,
        4.434659957885742,
        49.99856948852539
      ],
      [
        70,
        4.255568027496338,
        49.99833297729492
      ],
      [
        80,
        3.6327528953552246,
        49.99809646606445
      ],
      [
        90,
        4.373610973358154,
        49.99785614013672
      ],
      [
        100,
        3.8563852310180664,
        49.997703552246094
      ],
      [
        110,
        4.203547954559326,
        49.997581481933594
      ],
      [
        120,
        3.404106855392456,
        49.99745178222656
      ],
      [
        130,
        4.618293762207031,
        49.99732971191406
      ],
      [
        140,
        3.7907724380493164,
        49.99721145629883
      ],
      [
        150,
        3.8664088249206543,
        49.997093200683594
      ],
      [
        160,
        4.359457015991211,
        49.99697494506836
      ],
      [
        170,
        3.2703726291656494,
        49.99690246582031
      ],
      [
        180,
        3.57566499710083,
        49.99690246582031
      ],
      [
        190,
        3.9118494987487793,
        49.99687957763672
      ],
      [
        200,
        3.6932373046875,
        49.99680709838867
      ],
      [
        210,
        3.4584412574768066,
        49.99680709838867
      ],
      [
        220,
        3.3630614280700684,
        49.99680709838867
      ],
      [
        230,
        3.1569533348083496,
        49.99680709838867
      ],
      [
        240,
        4.1304521560668945,
        49.99680709838867
      ],
      [
        250,
        3.8763482570648193,
        49.99680709838867
      ],
      [
        260,
        3.460463047027588,
        49.99680709838867
      ],
      [
        270,
        3.499481678009033,
        49.99680709838867
      ],
      [
        280,
        3.5493178367614746,
        49.99680709838867
      ],
      [
        290,
        3.749704360961914,
        49.99680709838867
      ],
      [
        299,
        3.2818408012390137,
        49.99680709838867
      ]
    ],
    "0.20": [
      [
        0,
        4.231833457946777,
        49.99678039550781
      ],
      [
        10,
        4.332149505615234,
        49.996543884277344
      ],
      [
        20,
        4.044973373413086,
        49.996307373046875
      ],
      [
        30,
        3.839369297027588,
        49.99606704711914
      ],
      [
        40,
        4.2604079246521,
        49.99583053588867
      ],
      [
        50,
        3.9252772331237793,
        49.99559020996094
      ],
      [
        60,
        3.9559221267700195,
        49.9953498840332
      ],
      [
        70,
        3.5260891914367676,
        49.9951171875
      ],
      [
        80,
        4.240891933441162,
        49.994876861572266
      ],
      [
        90,
        4.231358528137207,
        49.99463653564453
      ],
      [
        100,
        3.8975977897644043,
        49.99446105957031
      ],
      [
        110,
        4.103560924530029,
        49.99433898925781
      ],
      [
        120,
        3.508927822113037,
        49.99422073364258
      ],
      [
        130,
        3.8603577613830566,
        49.99409866333008
      ],
      [
        140,
        3.4650487899780273,
        49.993980407714844
      ],
      [
        150,
        3.4396779537200928,
        49.993865966796875
      ],
      [
        160,
        3.9255669116973877,
        49.993743896484375
      ],
      [
        170,
        4.3631744384765625,
        49.99362564086914
      ],
      [
        180,
        2.857977867126465,
        49.9935302734375
      ],
      [
        190,
        3.798344612121582,
        49.9935188293457
      ],
      [
        200,
        4.338212013244629,
        49.9935188293457
      ],
      [
        210,
        3.5292890071868896,
        49.99346923828125
      ],
      [
        220,
        3.6945719718933105,
        49.99346923828125
      ],
      [
        230,
        3.6174328327178955,
        49.99346923828125
      ],
      [
        240,
        3.376394033432007,
        49.993408203125
      ],
      [
        250,
        3.375872850418091,
        49.993408203125
      ],
      [
        260,
        3.901501417160034,
        49.993408203125
      ],
      [
        270,
        4.005998611450195,
        49.993408203125
      ],
      [
        280,
        3.313206911087036,
        49.993408203125
      ],
      [
        290,
        3.3775391578674316,
        49.99348068237305
      ],
      [
        299,
        3.56659197807312,
        49.993553161621094
      ]
    ],
    "0.80": [
      [
        0,
        4.175843238830566,
        49.9935302734375
      ],
      [
        10,
        4.685196399688721,
        49.993289947509766
      ],
      [
        20,
        4.75559139251709,
        49.99304962158203
      ],
      [
        30,
        4.210165977478027,
        49.99281692504883
      ],
      [
        40,
        4.174988269805908,
        49.992576599121094
      ],
      [
        50,
        3.5690276622772217,
        49.99233627319336
      ],
      [
        60,
        3.1517817974090576,
        49.99209976196289
      ],
      [
        70,
        4.295135021209717,
        49.991859436035156
      ],
      [
        80,
        3.5744214057922363,
        49.99162292480469
      ],
      [
        90,
        3.70705246925354,
        49.991432189941406
      ],
      [
        100,
        3.6077303886413574,
        49.991310119628906
      ],
      [
        110,
        3.508831024169922,
        49.99110794067383
      ],
      [
        120,
        3.9285013675689697,
        49.99090576171875
      ],
      [
        130,
        3.9277753829956055,
        49.990787506103516
      ],
      [
        140,
        3.8054370880126953,
        49.990665435791016
      ],
      [
        150,
        3.9174411296844482,
        49.99054718017578
      ],
      [
        160,
        3.185824155807495,
        49.99043273925781
      ],
      [
        170,
        3.7693583965301514,
        49.99031066894531
      ],
      [
        180,
        3.5297889709472656,
        49.990203857421875
      ],
      [
        190,
        3.4814019203186035,
        49.99013137817383
      ],
      [
        200,
        3.890613555908203,
        49.990074157714844
      ],
      [
        210,
        3.338697910308838,
        49.9900016784668
      ],
      [
        220,
        3.8230807781219482,
        49.9900016784668
      ],
      [
        230,
        3.8465774059295654,
        49.989990234375
      ],
      [
        240,
        3.326303720474243,
        49.989990234375
      ],
      [
        250,
        3.928727626800537,
        49.989990234375
      ],
      [
        260,
        3.1391639709472656,
        49.989990234375
      ],
      [
        270,
        3.032417058944702,
        49.989990234375
      ],
      [
        280,
        3.6156201362609863,
        49.989990234375
      ],
      [
        290,
        3.684570789337158,
        49.989990234375
      ],
      [
        299,
        3.339566230773926,
        49.989990234375
      ]
    ]
  },
  "summary": [
    {
      "split": "train",
      "metric": "t2i@1",
      "baseline": 0.0571345224204034,
      "chunk_baseline": 0.0571345224204034,
      "adapter_0.00": 0.05780130021670278,
      "adapter_0.20": 0.05755125854309052,
      "adapter_0.80": 0.05738456409401567
    },
    {
      "split": "train",
      "metric": "t2i@5",
      "baseline": 0.13606434405734288,
      "chunk_baseline": 0.1361060176696116,
      "adapter_0.00": 0.1456076012668778,
      "adapter_0.20": 0.1455242540423404,
      "adapter_0.80": 0.1456076012668778
    },
    {
      "split": "train",
      "metric": "t2i@10",
      "baseline": 0.191073512252042,
      "chunk_baseline": 0.191073512252042,
      "adapter_0.00": 0.2041590265044174,
      "adapter_0.20": 0.20515919319886647,
      "adapter_0.80": 0.20553425570928488
    },
    {
      "split": "train",
      "metric": "i2t@1",
      "baseline": 0.13275,
      "chunk_baseline": 0.1335,
      "adapter_0.00": 0.14725,
      "adapter_0.20": 0.14825,
      "adapter_0.80": 0.14775
    },
    {
      "split": "train",
      "metric": "i2t@5",
      "baseline": 0.27175,
      "chunk_baseline": 0.27175,
      "adapter_0.00": 0.29775,
      "adapter_0.20": 0.2975,
      "adapter_0.80": 0.30075
    },
    {
      "split": "train",
      "metric": "i2t@10",
      "baseline": 0.34625,
      "chunk_baseline": 0.34625,
      "adapter_0.00": 0.39775,
      "adapter_0.20": 0.393,
      "adapter_0.80": 0.39475
    },
    {
      "split": "val",
      "metric": "t2i@1",
      "baseline": 0.15366666666666667,
      "chunk_baseline": 0.15366666666666667,
      "adapter_0.00": 0.168,
      "adapter_0.20": 0.16866666666666666,
      "adapter_0.80": 0.16633333333333333
    },
    {
      "split": "val",
      "metric": "t2i@5",
      "baseline": 0.3506666666666667,
      "chunk_baseline": 0.3506666666666667,
      "adapter_0.00": 0.371,
      "adapter_0.20": 0.37133333333333335,
      "adapter_0.80": 0.371
    },
    {
      "split": "val",
      "metric": "t2i@10",
      "baseline": 0.455,
      "chunk_baseline": 0.455,
      "adapter_0.00": 0.48633333333333334,
      "adapter_0.20": 0.48633333333333334,
      "adapter_0.80": 0.488
    },
    {
      "split": "val",
      "metric": "i2t@1",
      "baseline": 0.29,
      "chunk_baseline": 0.29,
      "adapter_0.00": 0.318,
      "adapter_0.20": 0.322,
      "adapter_0.80": 0.32
    },
    {
      "split": "val",
      "metric": "i2t@5",
      "baseline": 0.54,
      "chunk_baseline": 0.54,
      "adapter_0.00": 0.6,
      "adapter_0.20": 0.618,
      "adapter_0.80": 0.598
    },
    {
      "split": "val",
      "metric": "i2t@10",
      "baseline": 0.684,
      "chunk_baseline": 0.684,
      "adapter_0.00": 0.742,
      "adapter_0.20": 0.738,
      "adapter_0.80": 0.734
    },
    {
      "split": "test",
      "metric": "t2i@1",
      "baseline": 0.13866666666666666,
      "chunk_baseline": 0.138,
      "adapter_0.00": 0.155,
      "adapter_0.20": 0.152,
      "adapter_0.80": 0.15333333333333332
    },
    {
      "split": "test",
      "metric": "t2i@5",
      "baseline": 0.321,
      "chunk_baseline": 0.32066666666666666,
      "adapter_0.00": 0.352,
      "adapter_0.20": 0.35433333333333333,
      "adapter_0.80": 0.34833333333333333
    },
    {
      "split": "test",
      "metric": "t2i@10",
      "baseline": 0.43366666666666664,
      "chunk_baseline": 0.43333333333333335,
      "adapter_0.00": 0.4593333333333333,
      "adapter_0.20": 0.46166666666666667,
      "adapter_0.80": 0.461
    },
    {
      "split": "test",
      "metric": "i2t@1",
      "baseline": 0.278,
      "chunk_baseline": 0.278,
      "adapter_0.00": 0.32,
      "adapter_0.20": 0.314,
      "adapter_0.80": 0.314
    },
    {
      "split": "test",
      "metric": "i2t@5",
      "baseline": 0.508,
      "chunk_baseline": 0.506,
      "adapter_0.00": 0.554,
      "adapter_0.20": 0.558,
      "adapter_0.80": 0.568
    },
    {
      "split": "test",
      "metric": "i2t@10",
      "baseline": 0.604,
      "chunk_baseline": 0.602,
      "adapter_0.00": 0.686,
      "adapter_0.20": 0.682,
      "adapter_0.80": 0.686
    }
  ]
}