{
  "config": {
    "model_name": "ViT-B-32",
    "pretrained": "laion2b_s34b_b79k",
    "device_preference": "cuda",
    "seed": 42,
    "run_splits": [
      "train",
      "val",
      "test"
    ],
    "limit_images": null,
    "batch_size": 32,
    "k_values": [
      1,
      5,
      10
    ],
    "chunk_words": 8,
    "chunk_stride": 4,
    "chunk_threshold": 15,
    "text_pooling": "attn",
    "adapter_steps": 300,
    "adapter_lr": 1e-05,
    "adapter_logit_lr": 5e-07,
    "adapter_batch": 64,
    "adapter_hidden": 128,
    "distill_weights": [
      0.0,
      0.2,
      0.8
    ],
    "fine_grained_weight": 0.5,
    "cache_chunk_image_embeds": true,
    "teacher_cache_on_cpu": true,
    "output_name": "vg_full_cw8_attn_h128_attn",
    "process_config": {
      "max_images": 5000,
      "max_regions_per_image": 6,
      "min_region_words": 3,
      "validation_ratio": 0.1,
      "test_ratio": 0.1,
      "seed": 42,
      "lowercase": false
    },
    "show_progress": true
  },
  "paths": {
    "repo_root": "/content/comp545_final_github",
    "data_root": "/content/drive/MyDrive/comp545_data",
    "raw_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome_raw",
    "processed_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome",
    "images_dir": "/content/drive/MyDrive/comp545_data/visual_genome/images",
    "output_dir": "/content/drive/MyDrive/comp545_outputs",
    "cache_dir": "/content/drive/MyDrive/comp545_outputs/cache"
  },
  "baseline_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.13606434405734288,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.13275,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.13866666666666666,
        "5": 0.321,
        "10": 0.43366666666666664
      },
      "i2t": {
        "1": 0.278,
        "5": 0.508,
        "10": 0.604
      }
    }
  },
  "chunk_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.1361060176696116,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.1335,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.138,
        "5": 0.32066666666666666,
        "10": 0.43333333333333335
      },
      "i2t": {
        "1": 0.278,
        "5": 0.506,
        "10": 0.602
      }
    }
  },
  "adapter_metrics": {
    "0.0": {
      "train": {
        "t2i": {
          "1": 0.056592765460910154,
          "5": 0.14648274712452075,
          "10": 0.20711785297549593
        },
        "i2t": {
          "1": 0.149,
          "5": 0.30675,
          "10": 0.40075
        }
      },
      "val": {
        "t2i": {
          "1": 0.17366666666666666,
          "5": 0.36833333333333335,
          "10": 0.49266666666666664
        },
        "i2t": {
          "1": 0.32,
          "5": 0.61,
          "10": 0.74
        }
      },
      "test": {
        "t2i": {
          "1": 0.15433333333333332,
          "5": 0.36133333333333334,
          "10": 0.469
        },
        "i2t": {
          "1": 0.332,
          "5": 0.566,
          "10": 0.698
        }
      }
    },
    "0.2": {
      "train": {
        "t2i": {
          "1": 0.05705117519586598,
          "5": 0.1469828304717453,
          "10": 0.20786797799633272
        },
        "i2t": {
          "1": 0.147,
          "5": 0.30225,
          "10": 0.40175
        }
      },
      "val": {
        "t2i": {
          "1": 0.174,
          "5": 0.37333333333333335,
          "10": 0.496
        },
        "i2t": {
          "1": 0.334,
          "5": 0.608,
          "10": 0.736
        }
      },
      "test": {
        "t2i": {
          "1": 0.15533333333333332,
          "5": 0.358,
          "10": 0.47333333333333333
        },
        "i2t": {
          "1": 0.332,
          "5": 0.57,
          "10": 0.696
        }
      }
    },
    "0.8": {
      "train": {
        "t2i": {
          "1": 0.0556759459909985,
          "5": 0.14685780963493916,
          "10": 0.20732622103683948
        },
        "i2t": {
          "1": 0.14925,
          "5": 0.305,
          "10": 0.403
        }
      },
      "val": {
        "t2i": {
          "1": 0.172,
          "5": 0.371,
          "10": 0.5
        },
        "i2t": {
          "1": 0.33,
          "5": 0.598,
          "10": 0.738
        }
      },
      "test": {
        "t2i": {
          "1": 0.154,
          "5": 0.35733333333333334,
          "10": 0.47733333333333333
        },
        "i2t": {
          "1": 0.332,
          "5": 0.572,
          "10": 0.704
        }
      }
    }
  },
  "loss_logs": {
    "0.00": [
      [
        0,
        5.851855278015137,
        50.000003814697266
      ],
      [
        10,
        3.8244142532348633,
        49.99976348876953
      ],
      [
        20,
        3.610919237136841,
        49.9995231628418
      ],
      [
        30,
        3.9366939067840576,
        49.99928283691406
      ],
      [
        40,
        4.687539100646973,
        49.99905014038086
      ],
      [
        50,
        3.487668991088867,
        49.998809814453125
      ],
      [
        60,
        4.228254795074463,
        49.99863052368164
      ],
      [
        70,
        4.077180862426758,
        49.998512268066406
      ],
      [
        80,
        3.4998855590820312,
        49.998390197753906
      ],
      [
        90,
        4.182600021362305,
        49.99827194213867
      ],
      [
        100,
        3.7337419986724854,
        49.99815368652344
      ],
      [
        110,
        4.043923377990723,
        49.998046875
      ],
      [
        120,
        3.318993091583252,
        49.99800109863281
      ],
      [
        130,
        4.4466776847839355,
        49.99800109863281
      ],
      [
        140,
        3.7052769660949707,
        49.99800109863281
      ],
      [
        150,
        3.7481493949890137,
        49.99800109863281
      ],
      [
        160,
        4.226921081542969,
        49.99800109863281
      ],
      [
        170,
        3.1958813667297363,
        49.99800109863281
      ],
      [
        180,
        3.454444408416748,
        49.99800109863281
      ],
      [
        190,
        3.7984066009521484,
        49.99800109863281
      ],
      [
        200,
        3.6113526821136475,
        49.99800109863281
      ],
      [
        210,
        3.382408380508423,
        49.99800109863281
      ],
      [
        220,
        3.3065414428710938,
        49.99800109863281
      ],
      [
        230,
        3.025390148162842,
        49.99800109863281
      ],
      [
        240,
        4.013375282287598,
        49.99800109863281
      ],
      [
        250,
        3.7442831993103027,
        49.99800109863281
      ],
      [
        260,
        3.354647636413574,
        49.99800109863281
      ],
      [
        270,
        3.4268550872802734,
        49.99800109863281
      ],
      [
        280,
        3.4657557010650635,
        49.99800109863281
      ],
      [
        290,
        3.641794204711914,
        49.99800109863281
      ],
      [
        299,
        3.1774587631225586,
        49.99800109863281
      ]
    ],
    "0.20": [
      [
        0,
        4.231877326965332,
        49.99797439575195
      ],
      [
        10,
        4.272731781005859,
        49.99773406982422
      ],
      [
        20,
        3.9576826095581055,
        49.997501373291016
      ],
      [
        30,
        3.7221288681030273,
        49.99726104736328
      ],
      [
        40,
        4.124556541442871,
        49.99702072143555
      ],
      [
        50,
        3.7701616287231445,
        49.99678039550781
      ],
      [
        60,
        3.8048653602600098,
        49.996604919433594
      ],
      [
        70,
        3.4022672176361084,
        49.9964714050293
      ],
      [
        80,
        3.9774296283721924,
        49.99635696411133
      ],
      [
        90,
        4.037596225738525,
        49.99623489379883
      ],
      [
        100,
        3.755632162094116,
        49.996116638183594
      ],
      [
        110,
        3.937838315963745,
        49.99602127075195
      ],
      [
        120,
        3.4110829830169678,
        49.99602127075195
      ],
      [
        130,
        3.7422473430633545,
        49.99602127075195
      ],
      [
        140,
        3.350771188735962,
        49.99602127075195
      ],
      [
        150,
        3.3413431644439697,
        49.99602127075195
      ],
      [
        160,
        3.751268148422241,
        49.99602127075195
      ],
      [
        170,
        4.230245113372803,
        49.99602127075195
      ],
      [
        180,
        2.7937917709350586,
        49.99602127075195
      ],
      [
        190,
        3.6930313110351562,
        49.99602127075195
      ],
      [
        200,
        4.26599645614624,
        49.99602127075195
      ],
      [
        210,
        3.40689754486084,
        49.99602127075195
      ],
      [
        220,
        3.5747275352478027,
        49.99602127075195
      ],
      [
        230,
        3.4983677864074707,
        49.99602127075195
      ],
      [
        240,
        3.3275012969970703,
        49.995994567871094
      ],
      [
        250,
        3.2873446941375732,
        49.995994567871094
      ],
      [
        260,
        3.803280830383301,
        49.995994567871094
      ],
      [
        270,
        3.8839638233184814,
        49.995994567871094
      ],
      [
        280,
        3.2315518856048584,
        49.995994567871094
      ],
      [
        290,
        3.275434732437134,
        49.99607849121094
      ],
      [
        299,
        3.4729738235473633,
        49.996150970458984
      ]
    ],
    "0.80": [
      [
        0,
        4.17592716217041,
        49.99612808227539
      ],
      [
        10,
        4.6252522468566895,
        49.995887756347656
      ],
      [
        20,
        4.650631427764893,
        49.99564743041992
      ],
      [
        30,
        4.09503173828125,
        49.99541473388672
      ],
      [
        40,
        4.032097339630127,
        49.995174407958984
      ],
      [
        50,
        3.4853732585906982,
        49.99493408203125
      ],
      [
        60,
        3.081322193145752,
        49.99470901489258
      ],
      [
        70,
        4.074955463409424,
        49.994590759277344
      ],
      [
        80,
        3.4476680755615234,
        49.99447250366211
      ],
      [
        90,
        3.5374133586883545,
        49.99435043334961
      ],
      [
        100,
        3.4863386154174805,
        49.99427032470703
      ],
      [
        110,
        3.374814987182617,
        49.99414825439453
      ],
      [
        120,
        3.79107928276062,
        49.9940299987793
      ],
      [
        130,
        3.772426128387451,
        49.9940185546875
      ],
      [
        140,
        3.6524581909179688,
        49.9940185546875
      ],
      [
        150,
        3.847578525543213,
        49.9940185546875
      ],
      [
        160,
        3.0831902027130127,
        49.99400329589844
      ],
      [
        170,
        3.645382881164551,
        49.99400329589844
      ],
      [
        180,
        3.4096686840057373,
        49.99400329589844
      ],
      [
        190,
        3.3646812438964844,
        49.99400329589844
      ],
      [
        200,
        3.816188335418701,
        49.99400329589844
      ],
      [
        210,
        3.2463583946228027,
        49.99400329589844
      ],
      [
        220,
        3.7251687049865723,
        49.99400329589844
      ],
      [
        230,
        3.7219855785369873,
        49.99400329589844
      ],
      [
        240,
        3.18831467628479,
        49.99400329589844
      ],
      [
        250,
        3.812553644180298,
        49.99400329589844
      ],
      [
        260,
        3.0076496601104736,
        49.99400329589844
      ],
      [
        270,
        2.9152839183807373,
        49.99400329589844
      ],
      [
        280,
        3.52698016166687,
        49.99400329589844
      ],
      [
        290,
        3.5811314582824707,
        49.99400329589844
      ],
      [
        299,
        3.2709195613861084,
        49.99400329589844
      ]
    ]
  },
  "summary": [
    {
      "split": "train",
      "metric": "t2i@1",
      "baseline": 0.0571345224204034,
      "chunk_baseline": 0.0571345224204034,
      "adapter_0.00": 0.056592765460910154,
      "adapter_0.20": 0.05705117519586598,
      "adapter_0.80": 0.0556759459909985
    },
    {
      "split": "train",
      "metric": "t2i@5",
      "baseline": 0.13606434405734288,
      "chunk_baseline": 0.1361060176696116,
      "adapter_0.00": 0.14648274712452075,
      "adapter_0.20": 0.1469828304717453,
      "adapter_0.80": 0.14685780963493916
    },
    {
      "split": "train",
      "metric": "t2i@10",
      "baseline": 0.191073512252042,
      "chunk_baseline": 0.191073512252042,
      "adapter_0.00": 0.20711785297549593,
      "adapter_0.20": 0.20786797799633272,
      "adapter_0.80": 0.20732622103683948
    },
    {
      "split": "train",
      "metric": "i2t@1",
      "baseline": 0.13275,
      "chunk_baseline": 0.1335,
      "adapter_0.00": 0.149,
      "adapter_0.20": 0.147,
      "adapter_0.80": 0.14925
    },
    {
      "split": "train",
      "metric": "i2t@5",
      "baseline": 0.27175,
      "chunk_baseline": 0.27175,
      "adapter_0.00": 0.30675,
      "adapter_0.20": 0.30225,
      "adapter_0.80": 0.305
    },
    {
      "split": "train",
      "metric": "i2t@10",
      "baseline": 0.34625,
      "chunk_baseline": 0.34625,
      "adapter_0.00": 0.40075,
      "adapter_0.20": 0.40175,
      "adapter_0.80": 0.403
    },
    {
      "split": "val",
      "metric": "t2i@1",
      "baseline": 0.15366666666666667,
      "chunk_baseline": 0.15366666666666667,
      "adapter_0.00": 0.17366666666666666,
      "adapter_0.20": 0.174,
      "adapter_0.80": 0.172
    },
    {
      "split": "val",
      "metric": "t2i@5",
      "baseline": 0.3506666666666667,
      "chunk_baseline": 0.3506666666666667,
      "adapter_0.00": 0.36833333333333335,
      "adapter_0.20": 0.37333333333333335,
      "adapter_0.80": 0.371
    },
    {
      "split": "val",
      "metric": "t2i@10",
      "baseline": 0.455,
      "chunk_baseline": 0.455,
      "adapter_0.00": 0.49266666666666664,
      "adapter_0.20": 0.496,
      "adapter_0.80": 0.5
    },
    {
      "split": "val",
      "metric": "i2t@1",
      "baseline": 0.29,
      "chunk_baseline": 0.29,
      "adapter_0.00": 0.32,
      "adapter_0.20": 0.334,
      "adapter_0.80": 0.33
    },
    {
      "split": "val",
      "metric": "i2t@5",
      "baseline": 0.54,
      "chunk_baseline": 0.54,
      "adapter_0.00": 0.61,
      "adapter_0.20": 0.608,
      "adapter_0.80": 0.598
    },
    {
      "split": "val",
      "metric": "i2t@10",
      "baseline": 0.684,
      "chunk_baseline": 0.684,
      "adapter_0.00": 0.74,
      "adapter_0.20": 0.736,
      "adapter_0.80": 0.738
    },
    {
      "split": "test",
      "metric": "t2i@1",
      "baseline": 0.13866666666666666,
      "chunk_baseline": 0.138,
      "adapter_0.00": 0.15433333333333332,
      "adapter_0.20": 0.15533333333333332,
      "adapter_0.80": 0.154
    },
    {
      "split": "test",
      "metric": "t2i@5",
      "baseline": 0.321,
      "chunk_baseline": 0.32066666666666666,
      "adapter_0.00": 0.36133333333333334,
      "adapter_0.20": 0.358,
      "adapter_0.80": 0.35733333333333334
    },
    {
      "split": "test",
      "metric": "t2i@10",
      "baseline": 0.43366666666666664,
      "chunk_baseline": 0.43333333333333335,
      "adapter_0.00": 0.469,
      "adapter_0.20": 0.47333333333333333,
      "adapter_0.80": 0.47733333333333333
    },
    {
      "split": "test",
      "metric": "i2t@1",
      "baseline": 0.278,
      "chunk_baseline": 0.278,
      "adapter_0.00": 0.332,
      "adapter_0.20": 0.332,
      "adapter_0.80": 0.332
    },
    {
      "split": "test",
      "metric": "i2t@5",
      "baseline": 0.508,
      "chunk_baseline": 0.506,
      "adapter_0.00": 0.566,
      "adapter_0.20": 0.57,
      "adapter_0.80": 0.572
    },
    {
      "split": "test",
      "metric": "i2t@10",
      "baseline": 0.604,
      "chunk_baseline": 0.602,
      "adapter_0.00": 0.698,
      "adapter_0.20": 0.696,
      "adapter_0.80": 0.704
    }
  ]
}