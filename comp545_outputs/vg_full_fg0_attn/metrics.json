{
  "config": {
    "model_name": "ViT-B-32",
    "pretrained": "laion2b_s34b_b79k",
    "device_preference": "cuda",
    "seed": 42,
    "run_splits": [
      "train",
      "val",
      "test"
    ],
    "limit_images": null,
    "batch_size": 32,
    "k_values": [
      1,
      5,
      10
    ],
    "chunk_words": 8,
    "chunk_stride": 4,
    "chunk_threshold": 15,
    "text_pooling": "attn",
    "adapter_steps": 300,
    "adapter_lr": 1e-05,
    "adapter_logit_lr": 5e-07,
    "adapter_batch": 64,
    "adapter_hidden": 64,
    "distill_weights": [
      0.0,
      0.2,
      0.8
    ],
    "fine_grained_weight": 0.0,
    "cache_chunk_image_embeds": true,
    "teacher_cache_on_cpu": true,
    "output_name": "vg_full_fg0_attn",
    "process_config": {
      "max_images": 5000,
      "max_regions_per_image": 6,
      "min_region_words": 3,
      "validation_ratio": 0.1,
      "test_ratio": 0.1,
      "seed": 42,
      "lowercase": false
    },
    "show_progress": true
  },
  "paths": {
    "repo_root": "/content/comp545_final_github",
    "data_root": "/content/drive/MyDrive/comp545_data",
    "raw_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome_raw",
    "processed_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome",
    "images_dir": "/content/drive/MyDrive/comp545_data/visual_genome/images",
    "output_dir": "/content/drive/MyDrive/comp545_outputs",
    "cache_dir": "/content/drive/MyDrive/comp545_outputs/cache"
  },
  "baseline_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.13606434405734288,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.13275,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.13866666666666666,
        "5": 0.321,
        "10": 0.43366666666666664
      },
      "i2t": {
        "1": 0.278,
        "5": 0.508,
        "10": 0.604
      }
    }
  },
  "chunk_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.1361060176696116,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.1335,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.138,
        "5": 0.32066666666666666,
        "10": 0.43333333333333335
      },
      "i2t": {
        "1": 0.278,
        "5": 0.506,
        "10": 0.602
      }
    }
  },
  "adapter_metrics": {
    "0.0": {
      "train": {
        "t2i": {
          "1": 0.055759293215535924,
          "5": 0.14285714285714285,
          "10": 0.2027004500750125
        },
        "i2t": {
          "1": 0.14825,
          "5": 0.299,
          "10": 0.39975
        }
      },
      "val": {
        "t2i": {
          "1": 0.16533333333333333,
          "5": 0.37166666666666665,
          "10": 0.4846666666666667
        },
        "i2t": {
          "1": 0.318,
          "5": 0.604,
          "10": 0.742
        }
      },
      "test": {
        "t2i": {
          "1": 0.15266666666666667,
          "5": 0.3463333333333333,
          "10": 0.4573333333333333
        },
        "i2t": {
          "1": 0.326,
          "5": 0.564,
          "10": 0.688
        }
      }
    },
    "0.2": {
      "train": {
        "t2i": {
          "1": 0.0563843973995666,
          "5": 0.14214869144857475,
          "10": 0.20370061676946158
        },
        "i2t": {
          "1": 0.14725,
          "5": 0.299,
          "10": 0.39675
        }
      },
      "val": {
        "t2i": {
          "1": 0.168,
          "5": 0.36966666666666664,
          "10": 0.48433333333333334
        },
        "i2t": {
          "1": 0.32,
          "5": 0.606,
          "10": 0.738
        }
      },
      "test": {
        "t2i": {
          "1": 0.153,
          "5": 0.35133333333333333,
          "10": 0.4593333333333333
        },
        "i2t": {
          "1": 0.324,
          "5": 0.566,
          "10": 0.686
        }
      }
    },
    "0.8": {
      "train": {
        "t2i": {
          "1": 0.056509418236372726,
          "5": 0.14248208034672447,
          "10": 0.20245040840140024
        },
        "i2t": {
          "1": 0.15025,
          "5": 0.2985,
          "10": 0.40025
        }
      },
      "val": {
        "t2i": {
          "1": 0.16633333333333333,
          "5": 0.37033333333333335,
          "10": 0.4856666666666667
        },
        "i2t": {
          "1": 0.33,
          "5": 0.602,
          "10": 0.736
        }
      },
      "test": {
        "t2i": {
          "1": 0.153,
          "5": 0.342,
          "10": 0.4553333333333333
        },
        "i2t": {
          "1": 0.32,
          "5": 0.568,
          "10": 0.68
        }
      }
    }
  },
  "loss_logs": {
    "0.00": [
      [
        0,
        4.018248081207275,
        50.000003814697266
      ],
      [
        10,
        2.599330425262451,
        49.99976348876953
      ],
      [
        20,
        2.4609246253967285,
        49.9995231628418
      ],
      [
        30,
        2.737543821334839,
        49.99928283691406
      ],
      [
        40,
        3.2633750438690186,
        49.99905014038086
      ],
      [
        50,
        2.4694483280181885,
        49.998809814453125
      ],
      [
        60,
        2.9743096828460693,
        49.99856948852539
      ],
      [
        70,
        2.8678269386291504,
        49.99833297729492
      ],
      [
        80,
        2.4349608421325684,
        49.99809646606445
      ],
      [
        90,
        2.908370018005371,
        49.99785614013672
      ],
      [
        100,
        2.594444513320923,
        49.997703552246094
      ],
      [
        110,
        2.816073179244995,
        49.997581481933594
      ],
      [
        120,
        2.2933349609375,
        49.99746322631836
      ],
      [
        130,
        3.066776752471924,
        49.99734115600586
      ],
      [
        140,
        2.560105085372925,
        49.997222900390625
      ],
      [
        150,
        2.589768648147583,
        49.99710464477539
      ],
      [
        160,
        2.8929309844970703,
        49.996986389160156
      ],
      [
        170,
        2.208134174346924,
        49.99696350097656
      ],
      [
        180,
        2.386479377746582,
        49.99696350097656
      ],
      [
        190,
        2.625020742416382,
        49.99696350097656
      ],
      [
        200,
        2.480748176574707,
        49.99691390991211
      ],
      [
        210,
        2.3095178604125977,
        49.99691390991211
      ],
      [
        220,
        2.2479305267333984,
        49.99691390991211
      ],
      [
        230,
        2.098135471343994,
        49.99691390991211
      ],
      [
        240,
        2.757000684738159,
        49.99691390991211
      ],
      [
        250,
        2.5877950191497803,
        49.99691390991211
      ],
      [
        260,
        2.3215909004211426,
        49.99691390991211
      ],
      [
        270,
        2.3328499794006348,
        49.99691390991211
      ],
      [
        280,
        2.3790507316589355,
        49.99691390991211
      ],
      [
        290,
        2.491499900817871,
        49.99691390991211
      ],
      [
        299,
        2.1943271160125732,
        49.99691390991211
      ]
    ],
    "0.20": [
      [
        0,
        2.8430442810058594,
        49.99688720703125
      ],
      [
        10,
        2.893542766571045,
        49.99665451049805
      ],
      [
        20,
        2.73063063621521,
        49.99641418457031
      ],
      [
        30,
        2.5523343086242676,
        49.99617385864258
      ],
      [
        40,
        2.8777894973754883,
        49.99593734741211
      ],
      [
        50,
        2.6796529293060303,
        49.995697021484375
      ],
      [
        60,
        2.6310842037200928,
        49.995460510253906
      ],
      [
        70,
        2.3684170246124268,
        49.99522399902344
      ],
      [
        80,
        2.852783679962158,
        49.9949836730957
      ],
      [
        90,
        2.83980655670166,
        49.99474334716797
      ],
      [
        100,
        2.6215341091156006,
        49.99456787109375
      ],
      [
        110,
        2.7577905654907227,
        49.99443435668945
      ],
      [
        120,
        2.3546266555786133,
        49.99431610107422
      ],
      [
        130,
        2.584851026535034,
        49.99419403076172
      ],
      [
        140,
        2.3132450580596924,
        49.99407958984375
      ],
      [
        150,
        2.312162160873413,
        49.99395751953125
      ],
      [
        160,
        2.605086088180542,
        49.993839263916016
      ],
      [
        170,
        2.9197797775268555,
        49.993743896484375
      ],
      [
        180,
        1.915590524673462,
        49.99369430541992
      ],
      [
        190,
        2.545305013656616,
        49.99369430541992
      ],
      [
        200,
        2.8960351943969727,
        49.99369430541992
      ],
      [
        210,
        2.3707945346832275,
        49.99369430541992
      ],
      [
        220,
        2.46612286567688,
        49.99369430541992
      ],
      [
        230,
        2.412816047668457,
        49.99369430541992
      ],
      [
        240,
        2.2580227851867676,
        49.993682861328125
      ],
      [
        250,
        2.256594657897949,
        49.993682861328125
      ],
      [
        260,
        2.6029739379882812,
        49.993682861328125
      ],
      [
        270,
        2.6649839878082275,
        49.993682861328125
      ],
      [
        280,
        2.2183234691619873,
        49.993682861328125
      ],
      [
        290,
        2.2657742500305176,
        49.99376678466797
      ],
      [
        299,
        2.388803243637085,
        49.99385070800781
      ]
    ],
    "0.80": [
      [
        0,
        2.8157944679260254,
        49.99382781982422
      ],
      [
        10,
        3.169388771057129,
        49.993587493896484
      ],
      [
        20,
        3.227893352508545,
        49.993350982666016
      ],
      [
        30,
        2.86745285987854,
        49.99311065673828
      ],
      [
        40,
        2.8122148513793945,
        49.99287414550781
      ],
      [
        50,
        2.4329562187194824,
        49.99263381958008
      ],
      [
        60,
        2.107706069946289,
        49.99239730834961
      ],
      [
        70,
        2.8847782611846924,
        49.992156982421875
      ],
      [
        80,
        2.4113609790802,
        49.991920471191406
      ],
      [
        90,
        2.490576982498169,
        49.991729736328125
      ],
      [
        100,
        2.4283621311187744,
        49.991607666015625
      ],
      [
        110,
        2.354924201965332,
        49.991432189941406
      ],
      [
        120,
        2.635502815246582,
        49.99126434326172
      ],
      [
        130,
        2.6301510334014893,
        49.991146087646484
      ],
      [
        140,
        2.5500667095184326,
        49.99102783203125
      ],
      [
        150,
        2.604815721511841,
        49.99090576171875
      ],
      [
        160,
        2.1296799182891846,
        49.990787506103516
      ],
      [
        170,
        2.52185320854187,
        49.99070358276367
      ],
      [
        180,
        2.3721792697906494,
        49.99064636230469
      ],
      [
        190,
        2.325295925140381,
        49.99064636230469
      ],
      [
        200,
        2.5895111560821533,
        49.99064636230469
      ],
      [
        210,
        2.238050937652588,
        49.99060821533203
      ],
      [
        220,
        2.559844970703125,
        49.99060821533203
      ],
      [
        230,
        2.573420524597168,
        49.99060821533203
      ],
      [
        240,
        2.2217297554016113,
        49.99060821533203
      ],
      [
        250,
        2.616504192352295,
        49.99060821533203
      ],
      [
        260,
        2.087625741958618,
        49.99060821533203
      ],
      [
        270,
        2.02250337600708,
        49.99060821533203
      ],
      [
        280,
        2.4091577529907227,
        49.99060821533203
      ],
      [
        290,
        2.453097105026245,
        49.99060821533203
      ],
      [
        299,
        2.240450382232666,
        49.99060821533203
      ]
    ]
  },
  "summary": [
    {
      "split": "train",
      "metric": "t2i@1",
      "baseline": 0.0571345224204034,
      "chunk_baseline": 0.0571345224204034,
      "adapter_0.00": 0.055759293215535924,
      "adapter_0.20": 0.0563843973995666,
      "adapter_0.80": 0.056509418236372726
    },
    {
      "split": "train",
      "metric": "t2i@5",
      "baseline": 0.13606434405734288,
      "chunk_baseline": 0.1361060176696116,
      "adapter_0.00": 0.14285714285714285,
      "adapter_0.20": 0.14214869144857475,
      "adapter_0.80": 0.14248208034672447
    },
    {
      "split": "train",
      "metric": "t2i@10",
      "baseline": 0.191073512252042,
      "chunk_baseline": 0.191073512252042,
      "adapter_0.00": 0.2027004500750125,
      "adapter_0.20": 0.20370061676946158,
      "adapter_0.80": 0.20245040840140024
    },
    {
      "split": "train",
      "metric": "i2t@1",
      "baseline": 0.13275,
      "chunk_baseline": 0.1335,
      "adapter_0.00": 0.14825,
      "adapter_0.20": 0.14725,
      "adapter_0.80": 0.15025
    },
    {
      "split": "train",
      "metric": "i2t@5",
      "baseline": 0.27175,
      "chunk_baseline": 0.27175,
      "adapter_0.00": 0.299,
      "adapter_0.20": 0.299,
      "adapter_0.80": 0.2985
    },
    {
      "split": "train",
      "metric": "i2t@10",
      "baseline": 0.34625,
      "chunk_baseline": 0.34625,
      "adapter_0.00": 0.39975,
      "adapter_0.20": 0.39675,
      "adapter_0.80": 0.40025
    },
    {
      "split": "val",
      "metric": "t2i@1",
      "baseline": 0.15366666666666667,
      "chunk_baseline": 0.15366666666666667,
      "adapter_0.00": 0.16533333333333333,
      "adapter_0.20": 0.168,
      "adapter_0.80": 0.16633333333333333
    },
    {
      "split": "val",
      "metric": "t2i@5",
      "baseline": 0.3506666666666667,
      "chunk_baseline": 0.3506666666666667,
      "adapter_0.00": 0.37166666666666665,
      "adapter_0.20": 0.36966666666666664,
      "adapter_0.80": 0.37033333333333335
    },
    {
      "split": "val",
      "metric": "t2i@10",
      "baseline": 0.455,
      "chunk_baseline": 0.455,
      "adapter_0.00": 0.4846666666666667,
      "adapter_0.20": 0.48433333333333334,
      "adapter_0.80": 0.4856666666666667
    },
    {
      "split": "val",
      "metric": "i2t@1",
      "baseline": 0.29,
      "chunk_baseline": 0.29,
      "adapter_0.00": 0.318,
      "adapter_0.20": 0.32,
      "adapter_0.80": 0.33
    },
    {
      "split": "val",
      "metric": "i2t@5",
      "baseline": 0.54,
      "chunk_baseline": 0.54,
      "adapter_0.00": 0.604,
      "adapter_0.20": 0.606,
      "adapter_0.80": 0.602
    },
    {
      "split": "val",
      "metric": "i2t@10",
      "baseline": 0.684,
      "chunk_baseline": 0.684,
      "adapter_0.00": 0.742,
      "adapter_0.20": 0.738,
      "adapter_0.80": 0.736
    },
    {
      "split": "test",
      "metric": "t2i@1",
      "baseline": 0.13866666666666666,
      "chunk_baseline": 0.138,
      "adapter_0.00": 0.15266666666666667,
      "adapter_0.20": 0.153,
      "adapter_0.80": 0.153
    },
    {
      "split": "test",
      "metric": "t2i@5",
      "baseline": 0.321,
      "chunk_baseline": 0.32066666666666666,
      "adapter_0.00": 0.3463333333333333,
      "adapter_0.20": 0.35133333333333333,
      "adapter_0.80": 0.342
    },
    {
      "split": "test",
      "metric": "t2i@10",
      "baseline": 0.43366666666666664,
      "chunk_baseline": 0.43333333333333335,
      "adapter_0.00": 0.4573333333333333,
      "adapter_0.20": 0.4593333333333333,
      "adapter_0.80": 0.4553333333333333
    },
    {
      "split": "test",
      "metric": "i2t@1",
      "baseline": 0.278,
      "chunk_baseline": 0.278,
      "adapter_0.00": 0.326,
      "adapter_0.20": 0.324,
      "adapter_0.80": 0.32
    },
    {
      "split": "test",
      "metric": "i2t@5",
      "baseline": 0.508,
      "chunk_baseline": 0.506,
      "adapter_0.00": 0.564,
      "adapter_0.20": 0.566,
      "adapter_0.80": 0.568
    },
    {
      "split": "test",
      "metric": "i2t@10",
      "baseline": 0.604,
      "chunk_baseline": 0.602,
      "adapter_0.00": 0.688,
      "adapter_0.20": 0.686,
      "adapter_0.80": 0.68
    }
  ]
}