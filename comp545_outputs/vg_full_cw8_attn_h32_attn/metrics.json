{
  "config": {
    "model_name": "ViT-B-32",
    "pretrained": "laion2b_s34b_b79k",
    "device_preference": "cuda",
    "seed": 42,
    "run_splits": [
      "train",
      "val",
      "test"
    ],
    "limit_images": null,
    "batch_size": 32,
    "k_values": [
      1,
      5,
      10
    ],
    "chunk_words": 8,
    "chunk_stride": 4,
    "chunk_threshold": 15,
    "text_pooling": "attn",
    "adapter_steps": 300,
    "adapter_lr": 1e-05,
    "adapter_logit_lr": 5e-07,
    "adapter_batch": 64,
    "adapter_hidden": 32,
    "distill_weights": [
      0.0,
      0.2,
      0.8
    ],
    "fine_grained_weight": 0.5,
    "cache_chunk_image_embeds": true,
    "teacher_cache_on_cpu": true,
    "output_name": "vg_full_cw8_attn_h32_attn",
    "process_config": {
      "max_images": 5000,
      "max_regions_per_image": 6,
      "min_region_words": 3,
      "validation_ratio": 0.1,
      "test_ratio": 0.1,
      "seed": 42,
      "lowercase": false
    },
    "show_progress": true
  },
  "paths": {
    "repo_root": "/content/comp545_final_github",
    "data_root": "/content/drive/MyDrive/comp545_data",
    "raw_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome_raw",
    "processed_data_dir": "/content/drive/MyDrive/comp545_data/visual_genome",
    "images_dir": "/content/drive/MyDrive/comp545_data/visual_genome/images",
    "output_dir": "/content/drive/MyDrive/comp545_outputs",
    "cache_dir": "/content/drive/MyDrive/comp545_outputs/cache"
  },
  "baseline_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.13606434405734288,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.13275,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.13866666666666666,
        "5": 0.321,
        "10": 0.43366666666666664
      },
      "i2t": {
        "1": 0.278,
        "5": 0.508,
        "10": 0.604
      }
    }
  },
  "chunk_metrics": {
    "train": {
      "t2i": {
        "1": 0.0571345224204034,
        "5": 0.1361060176696116,
        "10": 0.191073512252042
      },
      "i2t": {
        "1": 0.1335,
        "5": 0.27175,
        "10": 0.34625
      }
    },
    "val": {
      "t2i": {
        "1": 0.15366666666666667,
        "5": 0.3506666666666667,
        "10": 0.455
      },
      "i2t": {
        "1": 0.29,
        "5": 0.54,
        "10": 0.684
      }
    },
    "test": {
      "t2i": {
        "1": 0.138,
        "5": 0.32066666666666666,
        "10": 0.43333333333333335
      },
      "i2t": {
        "1": 0.278,
        "5": 0.506,
        "10": 0.602
      }
    }
  },
  "adapter_metrics": {
    "0.0": {
      "train": {
        "t2i": {
          "1": 0.0585930988498083,
          "5": 0.14339889981663612,
          "10": 0.20320053342223704
        },
        "i2t": {
          "1": 0.14675,
          "5": 0.293,
          "10": 0.3795
        }
      },
      "val": {
        "t2i": {
          "1": 0.163,
          "5": 0.36466666666666664,
          "10": 0.478
        },
        "i2t": {
          "1": 0.308,
          "5": 0.604,
          "10": 0.732
        }
      },
      "test": {
        "t2i": {
          "1": 0.14933333333333335,
          "5": 0.3423333333333333,
          "10": 0.45666666666666667
        },
        "i2t": {
          "1": 0.304,
          "5": 0.546,
          "10": 0.666
        }
      }
    },
    "0.2": {
      "train": {
        "t2i": {
          "1": 0.05813468911485248,
          "5": 0.1430238373062177,
          "10": 0.2034089014835806
        },
        "i2t": {
          "1": 0.14575,
          "5": 0.291,
          "10": 0.37875
        }
      },
      "val": {
        "t2i": {
          "1": 0.16266666666666665,
          "5": 0.36533333333333334,
          "10": 0.4786666666666667
        },
        "i2t": {
          "1": 0.31,
          "5": 0.604,
          "10": 0.734
        }
      },
      "test": {
        "t2i": {
          "1": 0.151,
          "5": 0.346,
          "10": 0.45466666666666666
        },
        "i2t": {
          "1": 0.304,
          "5": 0.546,
          "10": 0.668
        }
      }
    },
    "0.8": {
      "train": {
        "t2i": {
          "1": 0.058426404400733455,
          "5": 0.14294049008168028,
          "10": 0.20390898483080513
        },
        "i2t": {
          "1": 0.14575,
          "5": 0.292,
          "10": 0.38125
        }
      },
      "val": {
        "t2i": {
          "1": 0.164,
          "5": 0.36033333333333334,
          "10": 0.47833333333333333
        },
        "i2t": {
          "1": 0.31,
          "5": 0.6,
          "10": 0.726
        }
      },
      "test": {
        "t2i": {
          "1": 0.14933333333333335,
          "5": 0.3453333333333333,
          "10": 0.4573333333333333
        },
        "i2t": {
          "1": 0.304,
          "5": 0.544,
          "10": 0.656
        }
      }
    }
  },
  "loss_logs": {
    "0.00": [
      [
        0,
        5.851855278015137,
        50.000003814697266
      ],
      [
        10,
        3.8751587867736816,
        49.99976348876953
      ],
      [
        20,
        3.7420616149902344,
        49.9995231628418
      ],
      [
        30,
        4.16869592666626,
        49.99928283691406
      ],
      [
        40,
        4.939548015594482,
        49.99905014038086
      ],
      [
        50,
        3.7572569847106934,
        49.998809814453125
      ],
      [
        60,
        4.6085205078125,
        49.99856948852539
      ],
      [
        70,
        4.412042140960693,
        49.99833297729492
      ],
      [
        80,
        3.7836039066314697,
        49.99809646606445
      ],
      [
        90,
        4.582120895385742,
        49.99785614013672
      ],
      [
        100,
        4.01606559753418,
        49.997615814208984
      ],
      [
        110,
        4.443816661834717,
        49.997379302978516
      ],
      [
        120,
        3.542020559310913,
        49.99713897705078
      ],
      [
        130,
        4.852926254272461,
        49.99691390991211
      ],
      [
        140,
        3.9583563804626465,
        49.99667739868164
      ],
      [
        150,
        4.061179161071777,
        49.99650955200195
      ],
      [
        160,
        4.602226734161377,
        49.99633026123047
      ],
      [
        170,
        3.3828558921813965,
        49.996212005615234
      ],
      [
        180,
        3.734456777572632,
        49.996089935302734
      ],
      [
        190,
        4.064032554626465,
        49.9959716796875
      ],
      [
        200,
        3.804928779602051,
        49.995849609375
      ],
      [
        210,
        3.5493979454040527,
        49.99573516845703
      ],
      [
        220,
        3.408139228820801,
        49.9956169128418
      ],
      [
        230,
        3.286140203475952,
        49.9954948425293
      ],
      [
        240,
        4.275131702423096,
        49.99537658691406
      ],
      [
        250,
        4.012689590454102,
        49.99525833129883
      ],
      [
        260,
        3.5509891510009766,
        49.99513626098633
      ],
      [
        270,
        3.577773332595825,
        49.99509048461914
      ],
      [
        280,
        3.6575841903686523,
        49.99509048461914
      ],
      [
        290,
        3.884976625442505,
        49.995079040527344
      ],
      [
        299,
        3.3762924671173096,
        49.995079040527344
      ]
    ],
    "0.20": [
      [
        0,
        4.2317705154418945,
        49.995052337646484
      ],
      [
        10,
        4.3589019775390625,
        49.994815826416016
      ],
      [
        20,
        4.0862908363342285,
        49.99457931518555
      ],
      [
        30,
        3.901611089706421,
        49.99433898925781
      ],
      [
        40,
        4.337854862213135,
        49.99409866333008
      ],
      [
        50,
        4.0251994132995605,
        49.993865966796875
      ],
      [
        60,
        4.056669235229492,
        49.99362564086914
      ],
      [
        70,
        3.6407470703125,
        49.993385314941406
      ],
      [
        80,
        4.4380669593811035,
        49.99314498901367
      ],
      [
        90,
        4.416650772094727,
        49.9929084777832
      ],
      [
        100,
        4.051911354064941,
        49.992671966552734
      ],
      [
        110,
        4.280759334564209,
        49.992431640625
      ],
      [
        120,
        3.6511707305908203,
        49.99219512939453
      ],
      [
        130,
        4.030659198760986,
        49.9919548034668
      ],
      [
        140,
        3.563234806060791,
        49.99171447753906
      ],
      [
        150,
        3.5747830867767334,
        49.99148941040039
      ],
      [
        160,
        4.09882116317749,
        49.99134826660156
      ],
      [
        170,
        4.547323226928711,
        49.99119186401367
      ],
      [
        180,
        2.904884099960327,
        49.99107360839844
      ],
      [
        190,
        3.9032156467437744,
        49.9909553527832
      ],
      [
        200,
        4.461596488952637,
        49.99083709716797
      ],
      [
        210,
        3.6304736137390137,
        49.99071502685547
      ],
      [
        220,
        3.823176860809326,
        49.990596771240234
      ],
      [
        230,
        3.7419300079345703,
        49.990478515625
      ],
      [
        240,
        3.438626766204834,
        49.9903564453125
      ],
      [
        250,
        3.4263453483581543,
        49.990238189697266
      ],
      [
        260,
        3.998548984527588,
        49.99016571044922
      ],
      [
        270,
        4.143645763397217,
        49.99008560180664
      ],
      [
        280,
        3.387613296508789,
        49.990074157714844
      ],
      [
        290,
        3.4556612968444824,
        49.990074157714844
      ],
      [
        299,
        3.6584980487823486,
        49.990074157714844
      ]
    ],
    "0.80": [
      [
        0,
        4.175729751586914,
        49.990047454833984
      ],
      [
        10,
        4.714466571807861,
        49.989810943603516
      ],
      [
        20,
        4.809617042541504,
        49.98957443237305
      ],
      [
        30,
        4.277423858642578,
        49.98933410644531
      ],
      [
        40,
        4.254809379577637,
        49.98909378051758
      ],
      [
        50,
        3.6312925815582275,
        49.98885726928711
      ],
      [
        60,
        3.2130401134490967,
        49.988616943359375
      ],
      [
        70,
        4.470173358917236,
        49.988380432128906
      ],
      [
        80,
        3.7081499099731445,
        49.98814392089844
      ],
      [
        90,
        3.8734543323516846,
        49.9879035949707
      ],
      [
        100,
        3.75050687789917,
        49.98766326904297
      ],
      [
        110,
        3.6657612323760986,
        49.987422943115234
      ],
      [
        120,
        4.093277931213379,
        49.98719024658203
      ],
      [
        130,
        4.1048383712768555,
        49.9869499206543
      ],
      [
        140,
        3.975461721420288,
        49.98670959472656
      ],
      [
        150,
        4.052815914154053,
        49.986473083496094
      ],
      [
        160,
        3.2984251976013184,
        49.98627853393555
      ],
      [
        170,
        3.903407573699951,
        49.98616409301758
      ],
      [
        180,
        3.676041841506958,
        49.986045837402344
      ],
      [
        190,
        3.577779769897461,
        49.985923767089844
      ],
      [
        200,
        4.016324043273926,
        49.98580551147461
      ],
      [
        210,
        3.4205336570739746,
        49.985687255859375
      ],
      [
        220,
        3.928880453109741,
        49.985565185546875
      ],
      [
        230,
        3.966235637664795,
        49.98544692993164
      ],
      [
        240,
        3.44990873336792,
        49.98533248901367
      ],
      [
        250,
        4.065138816833496,
        49.98521041870117
      ],
      [
        260,
        3.223034143447876,
        49.98509216308594
      ],
      [
        270,
        3.113524913787842,
        49.984981536865234
      ],
      [
        280,
        3.676133155822754,
        49.9848747253418
      ],
      [
        290,
        3.7791554927825928,
        49.98481750488281
      ],
      [
        299,
        3.4191296100616455,
        49.98481750488281
      ]
    ]
  },
  "summary": [
    {
      "split": "train",
      "metric": "t2i@1",
      "baseline": 0.0571345224204034,
      "chunk_baseline": 0.0571345224204034,
      "adapter_0.00": 0.0585930988498083,
      "adapter_0.20": 0.05813468911485248,
      "adapter_0.80": 0.058426404400733455
    },
    {
      "split": "train",
      "metric": "t2i@5",
      "baseline": 0.13606434405734288,
      "chunk_baseline": 0.1361060176696116,
      "adapter_0.00": 0.14339889981663612,
      "adapter_0.20": 0.1430238373062177,
      "adapter_0.80": 0.14294049008168028
    },
    {
      "split": "train",
      "metric": "t2i@10",
      "baseline": 0.191073512252042,
      "chunk_baseline": 0.191073512252042,
      "adapter_0.00": 0.20320053342223704,
      "adapter_0.20": 0.2034089014835806,
      "adapter_0.80": 0.20390898483080513
    },
    {
      "split": "train",
      "metric": "i2t@1",
      "baseline": 0.13275,
      "chunk_baseline": 0.1335,
      "adapter_0.00": 0.14675,
      "adapter_0.20": 0.14575,
      "adapter_0.80": 0.14575
    },
    {
      "split": "train",
      "metric": "i2t@5",
      "baseline": 0.27175,
      "chunk_baseline": 0.27175,
      "adapter_0.00": 0.293,
      "adapter_0.20": 0.291,
      "adapter_0.80": 0.292
    },
    {
      "split": "train",
      "metric": "i2t@10",
      "baseline": 0.34625,
      "chunk_baseline": 0.34625,
      "adapter_0.00": 0.3795,
      "adapter_0.20": 0.37875,
      "adapter_0.80": 0.38125
    },
    {
      "split": "val",
      "metric": "t2i@1",
      "baseline": 0.15366666666666667,
      "chunk_baseline": 0.15366666666666667,
      "adapter_0.00": 0.163,
      "adapter_0.20": 0.16266666666666665,
      "adapter_0.80": 0.164
    },
    {
      "split": "val",
      "metric": "t2i@5",
      "baseline": 0.3506666666666667,
      "chunk_baseline": 0.3506666666666667,
      "adapter_0.00": 0.36466666666666664,
      "adapter_0.20": 0.36533333333333334,
      "adapter_0.80": 0.36033333333333334
    },
    {
      "split": "val",
      "metric": "t2i@10",
      "baseline": 0.455,
      "chunk_baseline": 0.455,
      "adapter_0.00": 0.478,
      "adapter_0.20": 0.4786666666666667,
      "adapter_0.80": 0.47833333333333333
    },
    {
      "split": "val",
      "metric": "i2t@1",
      "baseline": 0.29,
      "chunk_baseline": 0.29,
      "adapter_0.00": 0.308,
      "adapter_0.20": 0.31,
      "adapter_0.80": 0.31
    },
    {
      "split": "val",
      "metric": "i2t@5",
      "baseline": 0.54,
      "chunk_baseline": 0.54,
      "adapter_0.00": 0.604,
      "adapter_0.20": 0.604,
      "adapter_0.80": 0.6
    },
    {
      "split": "val",
      "metric": "i2t@10",
      "baseline": 0.684,
      "chunk_baseline": 0.684,
      "adapter_0.00": 0.732,
      "adapter_0.20": 0.734,
      "adapter_0.80": 0.726
    },
    {
      "split": "test",
      "metric": "t2i@1",
      "baseline": 0.13866666666666666,
      "chunk_baseline": 0.138,
      "adapter_0.00": 0.14933333333333335,
      "adapter_0.20": 0.151,
      "adapter_0.80": 0.14933333333333335
    },
    {
      "split": "test",
      "metric": "t2i@5",
      "baseline": 0.321,
      "chunk_baseline": 0.32066666666666666,
      "adapter_0.00": 0.3423333333333333,
      "adapter_0.20": 0.346,
      "adapter_0.80": 0.3453333333333333
    },
    {
      "split": "test",
      "metric": "t2i@10",
      "baseline": 0.43366666666666664,
      "chunk_baseline": 0.43333333333333335,
      "adapter_0.00": 0.45666666666666667,
      "adapter_0.20": 0.45466666666666666,
      "adapter_0.80": 0.4573333333333333
    },
    {
      "split": "test",
      "metric": "i2t@1",
      "baseline": 0.278,
      "chunk_baseline": 0.278,
      "adapter_0.00": 0.304,
      "adapter_0.20": 0.304,
      "adapter_0.80": 0.304
    },
    {
      "split": "test",
      "metric": "i2t@5",
      "baseline": 0.508,
      "chunk_baseline": 0.506,
      "adapter_0.00": 0.546,
      "adapter_0.20": 0.546,
      "adapter_0.80": 0.544
    },
    {
      "split": "test",
      "metric": "i2t@10",
      "baseline": 0.604,
      "chunk_baseline": 0.602,
      "adapter_0.00": 0.666,
      "adapter_0.20": 0.668,
      "adapter_0.80": 0.656
    }
  ]
}